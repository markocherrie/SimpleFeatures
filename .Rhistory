geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
plot(x, y, col = km$cluster, pch = 20)
centres<-as.data.frame(km$centers)
#
original<-cbind(x,y,z)
fit<-lm(age~ x+y, original)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
plot(x, y, col = km$cluster, pch = 20)
centres<-as.data.frame(km$centers)
#
original<-cbind(x,y,z)
fit<-lm(age~ x+y, original)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
x<-c(0.960349811,1.828034289,3.970700857,5.319548408,3.655945058,8.382321698,8.799155117)
y<-c(8.740186269,7.109143012,7.966550557,4.98204007,4.348155834,4.83929939,1.797401122)
z<-data.frame(age=c(5,4,5,3,2,1,1))
# arrowplot function
arrowplot<-function(x,y,z){
coords<-cbind(x,y)
sp = SpatialPoints(coords)
spdf = SpatialPointsDataFrame(coords, data)
km <- kmeans(coords, centers = 2)
centres<-as.data.frame(km$centers)
original<-cbind(x,y,z)
start<-centres[which.min(centres$x),]
end<-centres[ !(centres$x %in% start$x), ]
library(ggplot2)
ggplot(original,aes(x = x,y = y, color=age))+
geom_point()+
geom_segment(aes(x = start$x,y = start$y,xend = end$x,yend = end$y),arrow=arrow())
}
arrowplot(x,y,z)
library(rCharts);library(rMaps);library(rgdal)
map = readOGR("https://raw.githubusercontent.com/gupierre/GHA_vol/master/Data/GHA_adm/GHA_adm1.topo.json", layer="admin_1",stringsAsFactors=F)
#Data:
SDLOG<-read.table("https://raw.githubusercontent.com/gupierre/GHA_vol/master/Data/sdlog.csv", header=T,stringsAsFactors=F, sep =",")
head(SDLOG)
library(rCharts);library(rMaps);library(rgdal)
install.packages("rCharts")
library(rCharts);library(rMaps);library(rgdal)
library(rCharts)
install.packages("plotrix")
library(plotrix)
?plotrix
floating.pie()
?floating.pie
print.function(floating.pie)
runApp('~/Win7/Desktop/legiscraper/app2')
read.csv(choose.file())
choose.file()
choose.files()
test<-read.csv("\\\\home1.geos.ed.ac.uk\\mcherrie\\Win7\\Desktop\\contact-form.csv")
View(test)
test[test$X_name=="mark"]<-NA
View(test)
View(test)
test[test$X_name=="mark"]
test[test$X_name=="mark"]<-NA
test[test$X_name=="mark",]<-NA
View(test)
library(htmlwidgets)
library(htmltools)
library(leaflet)
library(geojsonio)
power <- data.frame(
"Latitude" = c(33.515556, 38.060556, 47.903056, 49.71, 49.041667, 31.934167, 54.140586, 54.140586, 48.494444, 48.494444),
"Longitude" = c(129.837222, -77.789444, 7.563056, 8.415278, 9.175, -82.343889, 13.664422, 13.664422, 17.681944, 17.681944),
"start" = do.call(
"as.Date",
list(
x = c("15-Sep-1971", "1-Dec-1971", "1-Feb-1972", "1-Feb-1972", "1-Feb-1972", "1-Feb-1972", "1-Apr-1972", "1-Apr-1972", "24-Apr-1972", "24-Apr-1972"),
format = "%d-%b-%Y"
)
)
)
# set start same as end
#  adjust however you would like
power$end <- power$start
# use geojsonio to convert our data.frame
#  to GeoJSON which timeline expects
power_geo <- geojson_json(power,lat="Latitude",lon="Longitude")
# create a leaflet map on which we will build
leaf <- leaflet() %>%
addTiles()
# add leaflet-timeline as a dependency
#  to get the js and css
leaf$dependencies[[length(leaf$dependencies)+1]] <- htmlDependency(
name = "leaflet-timeline",
version = "1.0.0",
src = c("href" = "http://skeate.github.io/Leaflet.timeline/"),
script = "javascripts/leaflet.timeline.js",
stylesheet = "stylesheets/leaflet.timeline.css"
)
leaf %>%
setView(44.0665,23.74667,2) %>%
onRender(sprintf(
'
function(el,x){
var power_data = %s;
var timeline = L.timeline(power_data, {
pointToLayer: function(data, latlng){
var hue_min = 120;
var hue_max = 0;
var hue = hue_min;
return L.circleMarker(latlng, {
radius: 10,
color: "hsl("+hue+", 100%%, 50%%)",
fillColor: "hsl("+hue+", 100%%, 50%%)"
});
},
steps: 1000,
duration: 10000,
showTicks: true
});
timeline.addTo(HTMLWidgets.find(".leaflet"));
}
',
power_geo
))
pkgbuild::find_rtools()
library(tidyverse)
devtools::install_github("r-spatial/mapview@develop")
UPDATE
The utility find_rtools has been moved to the package pkgbuild (as noted in devtools News). The function pkgbuild::find_rtools() correctly discovers Rtools 3.5 in my system.
Old answer
I had this same problem and it occurs because devtools has not been updated to consider the newest version of RTools (3.5). Here is an easy fix that should work while they update the package:
# add missing RTools 3.5 info
v_i = devtools:::version_info
v_i[["3.5"]] = v_i[["3.4"]]
v_i[["3.5"]]$version_max = "3.5.99"
assignInNamespace(x     = "version_info",
value = v_i,
ns    = "devtools")
# now find_rtools should work properly
devtools::find_rtools()
devtools::find_rtools()
library(tidyverse)
# get Moves data
for (i in c("functions")){
source(paste0(i, ".R"), echo=TRUE)
}
setwd("~/")
setwd("C:/Users/mcherrie/Google Drive/Presentations/Presentations/SF/SF_example")
# devtools::install_github("r-spatial/mapview@develop")
library(tidyverse)
# get Moves data
for (i in c("functions")){
source(paste0(i, ".R"), echo=TRUE)
}
Usertrack<-GoogleRoute(mapkey= "AIzaSyBzfGHAchxz7FUjfipYrMsTUP7sVBAuh5s", latO=55.934544, lonO=-3.228447,
latD=55.947779, lonD=-3.184145, mode="walking")
tracks<-get_tracks("data/moves_export/")
activities<-get_activities("data/moves_export/")
places<-get_places("data/moves_export/")
# create a new directory for the Figures if one doesn't already exist
dir.create(file.path(getwd(), "figures"), showWarnings = FALSE)
### Download the data
library(sf)
greenspaces <- st_read("data/opgrsp_essh_nt/OS Open Greenspace (ESRI Shape File) NT/data/NT_GreenspaceSite.shp")
greenaccesspoints <- st_read("data/opgrsp_essh_nt/OS Open Greenspace (ESRI Shape File) NT/data/NT_AccessPoint.shp")
quietwalks <- st_read("data/Quiet_routes/Quiet_routes.kml")
plot(greenspaces)
plot(tracks)
library(dplyr)
library(mapview)
# Simple
tracks %>%
sf::st_as_sf(coords = c("longitude","latitude")) %>%
sf::st_set_crs(4326) %>%
st_cast("MULTIPOINT") %>%
plot(.)
tracks %>%
st_as_sf(., coords = c("longitude", "latitude"),crs = 4326) %>%
mapview(.)
devtools::install_github("r-spatial/mapview@develop")
devtools::install_github("r-spatial/mapview@develop")
# May need to update Rtools to 35
# https://cran.r-project.org/bin/windows/Rtools/
# devtools::install_github("r-spatial/mapview@develop")
library(tidyverse)
# get Moves data
for (i in c("functions")){
source(paste0(i, ".R"), echo=TRUE)
}
# Get google timeline data
#https://github.com/alexattia/Maps-Location-History
# Get user route
Usertrack<-GoogleRoute(mapkey= "AIzaSyBzfGHAchxz7FUjfipYrMsTUP7sVBAuh5s", latO=55.934544, lonO=-3.228447,
latD=55.947779, lonD=-3.184145, mode="walking")
# Now run the functions on the moves_export folder
# Download the moves data from here: https://accounts.moves-app.com/export
# unzip it and put it in your working directory
tracks<-get_tracks("data/moves_export/")
activities<-get_activities("data/moves_export/")
places<-get_places("data/moves_export/")
# Data already out there
# quiet walks: http://data.edinburghcouncilmaps.info/datasets/96e5de2cd18d417499c8874f2678e7f8_40?geometry=-4.043%2C55.822%2C-2.803%2C56.053
# green spaces: http://www.greenspacescotland.org.uk/1scotlands-greenspace-map.aspx
# create a new directory for the Figures if one doesn't already exist
dir.create(file.path(getwd(), "figures"), showWarnings = FALSE)
### Download the data
library(sf)
greenspaces <- st_read("data/opgrsp_essh_nt/OS Open Greenspace (ESRI Shape File) NT/data/NT_GreenspaceSite.shp")
greenaccesspoints <- st_read("data/opgrsp_essh_nt/OS Open Greenspace (ESRI Shape File) NT/data/NT_AccessPoint.shp")
quietwalks <- st_read("data/Quiet_routes/Quiet_routes.kml")
# plot it
mapviewOptions(basemaps = c("CartoDB.Positron", "OpenStreetMap","Esri.WorldImagery"),
layers.control.pos = "topright")
library(mapview)
m1<-mapview(quietwalks, zcol = "Name") + mapview(greenspaces, zcol = "function.", alpha = 0) + mapview(greenaccesspoints, zcol="accessType", alpha = 0)
m1
mapview(breweries)
library(mapview)
mapview(quietwalks, zcol = "Name")
