for (i in c("functions")){
source(paste0(i, ".R"), echo=TRUE)
}
install.packages("dtplyr")
for (i in c("functions")){
source(paste0(i, ".R"), echo=TRUE)
}
# Get user route
Usertrack<-GoogleRoute(mapkey= "AIzaSyBzfGHAchxz7FUjfipYrMsTUP7sVBAuh5s", latO=55.934544, lonO=-3.228447,
latD=55.947779, lonD=-3.184145, mode="walking")
plot(Usertrack)
quietwalks <- st_read("data/Quiet_routes/Quiet_routes.kml")
mapview(quietwalks)
tracks<-get_tracks("data/moves_export/")
activities<-get_activities("data/moves_export/")
places<-get_places("data/moves_export/")
places
View(activities)
quietwalks <- st_read("data/Quiet_routes/Quiet_routes.kml")
library(mapview)
mapview(quietwalks)
library(mapview)
install.packages("mapview")
quietwalks <- st_read("data/Quiet_routes/Quiet_routes.kml")
library(mapview)
mapview(quietwalks)
library(mapview)
install.packages("mapview")
library(mapview)
install.packages("mapview")
library(mapview)
install.packages("mapview")
library(mapview)
devtools::install_github("r-spatial/mapview@develop")
remove.packages("mapview")
remove.packages("sf")
devtools::install_github("r-spatial/mapview@develop")
mapviewOptions(basemaps = c("CartoDB.Positron", "OpenStreetMap","Esri.WorldImagery"),
layers.control.pos = "topright")
library(mapview)
m1<-mapview(quietwalks, zcol = "Name") + mapview(greenspaces, zcol = "function.", alpha = 0) + mapview(greenaccesspoints, zcol="accessType", alpha = 0)
m1
library(adehabitatHR)
tracks_sf_pt<-tracks %>%
sf::st_as_sf(coords = c("longitude","latitude")) %>%
sf::st_set_crs(4326) %>%
sf::st_transform(., 27700)
tracksSPDF<-as(tracks_sf_pt, "Spatial")
track_poly <- mcp(tracksSPDF[,4], percent=95)
mcp_sf_pt<-st_as_sf(track_poly, coords = c("longitude", "latitude"),crs = 27700)
m2<-mapview(mcp_sf_pt, zcol = "area", alpha.regions = 0.3)
m2
# get Moves data
for (i in c("functions")){
source(paste0(i, ".R"), echo=TRUE)
}
library(tidyverse)
### Download the data
library(sf)
greenspaces <- st_read("data/opgrsp_essh_nt/OS Open Greenspace (ESRI Shape File) NT/data/NT_GreenspaceSite.shp")
greenaccesspoints <- st_read("data/opgrsp_essh_nt/OS Open Greenspace (ESRI Shape File) NT/data/NT_AccessPoint.shp")
quietwalks <- st_read("data/Quiet_routes/Quiet_routes.kml")
# plot it
mapviewOptions(basemaps = c("CartoDB.Positron", "OpenStreetMap","Esri.WorldImagery"),
layers.control.pos = "topright")
library(mapview)
m1<-mapview(quietwalks, zcol = "Name") + mapview(greenspaces, zcol = "function.", alpha = 0) + mapview(greenaccesspoints, zcol="accessType", alpha = 0)
m1
##### Let's go a bit further with the moves data
library(dplyr)
library(mapview)
# Simple
tracks %>%
sf::st_as_sf(coords = c("longitude","latitude")) %>%
sf::st_set_crs(4326) %>%
st_cast("MULTIPOINT") %>%
plot(.)
# Geographic data - calculate Minimal convex polygon for each
mapviewOptions(basemaps = c("OpenStreetMap","CartoDB.Positron", "Esri.WorldImagery"),
layers.control.pos = "topright")
library(adehabitatHR)
tracks_sf_pt<-tracks %>%
sf::st_as_sf(coords = c("longitude","latitude")) %>%
sf::st_set_crs(4326) %>%
sf::st_transform(., 27700)
tracksSPDF<-as(tracks_sf_pt, "Spatial")
track_poly <- mcp(tracksSPDF[,4], percent=95)
mcp_sf_pt<-st_as_sf(track_poly, coords = c("longitude", "latitude"),crs = 27700)
m2<-mapview(mcp_sf_pt, zcol = "area", alpha.regions = 0.3)
m2
# read data in and format
labeldata<-readr::read_csv("visionoutput/labels.csv", col_names = F)
colnames(labeldata)<-c("description","score", "latitude", "longitude", "bearing")
# get the hyam labels
labels<-readr::read_csv("data/visionauxdata/labels.csv")
## add the missing labels
misslabels<-readr::read_csv("data/visionauxdata/missinglabels1.csv")
misslabels2<-readr::read_csv("data/visionauxdata/missinglabels2.csv")
labels<-rbind(labels, misslabels, misslabels2)
# get id colum
library(dplyr)
labeldata$photoid <- labeldata %>%
group_indices(latitude, longitude)
# remove photo labels that didnt work
labeldata<-labeldata[!(labeldata$score<0),]
# merge with labels
labeldata<-merge(labeldata, labels, by="description", all.x=T)
# create labels that haven't been defined
missinglabels<-subset(labeldata, is.na(naturalness))
if (nrow(missinglabels)>0){print("Add missing labels to label dataframe")}
# if Message then add the label categorise as natural, artificial or ambigious
#missinglabels<-as.data.frame(unique(missinglabels$description))
#colnames(missinglabels)<-"description"
#write.csv(missinglabels, "data/visionauxdata/missinglabels2.csv", row.names=F)
# create Calculated semantic naturalness
labeldata <-
labeldata %>%
group_by(photoid) %>%
mutate(CSN=(sum(naturalness == 1)/n())-(sum(naturalness == -1)/n())) %>%
mutate(CSN = round(CSN, 2)) %>%
distinct(latitude, longitude, photoid, CSN)
# Plot
mapviewOptions(basemaps = c("Esri.WorldImagery", "OpenStreetMap","CartoDB.Positron"),
layers.control.pos = "topright")
m3<-labeldata %>%
sf::st_as_sf(coords = c("longitude","latitude")) %>%
sf::st_set_crs(4326) %>%
sf::st_cast("MULTIPOINT") %>%
mapview(., zcol = "CSN", cex = "CSN", color = "black")
m3
# Let's bring it all together now
sync(m1, m2, m3)
